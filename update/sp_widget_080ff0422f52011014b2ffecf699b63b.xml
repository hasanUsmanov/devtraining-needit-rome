<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[api.controller=function() {
	/* widget controller */
	// Define our hard-coded data
	//var data = [{"category": "Hardware", "value": 10}, {"category": "Software", "value": 24}, {"category": "Inquiry", "value": 14}, {"category": "Network", "value": 34}];
var c = this;
	// Set the width of the chart along with the height of each bar
	var width = 600,
		barHeight = 20;

	var chart = d3.select(".chart")
					.attr("width", width)
					.attr("height", barHeight * c.data.categories.length);
	
	// Create a function to automatically scale the bars correctly
	var x = d3.scaleLinear()
				.range([0, width])
				.domain([0, d3.max(c.data.categories, function(d) { return d.value; })]);
	
	// Add a g container for each row from our data
	var bar = chart.selectAll("g")
					.data(c.data.categories)
					.enter().append("g")
					.attr("transform", function(d, i) { return "translate(0," + i * barHeight + ")"; });

	// Add a rectangle element with the width based off of the value from that row of data
	bar.append("rect")
		.attr("width", function(d) { return x(d.value); })
		.attr("height", barHeight - 1);

	// Add text elements to serve as labels of our categories and values
	bar.append("text")
		.attr("x", 3)
		.attr("y", barHeight / 2)
		.attr("dy", ".35em")
		.text(function(d) { return d.category; });

	bar.append("text")
		.attr("x", function(d) { return x(d.value) - 15; })
		.attr("y", barHeight / 2)
		.attr("dy", ".35em")
		.text(function(d) { return d.value; });

};]]></client_script>
        <controller_as>c</controller_as>
        <css>.chart rect {&#13;
&#13;
  fill: steelblue;&#13;
&#13;
}&#13;
&#13;
.chart text {&#13;
&#13;
  fill: white;&#13;
&#13;
  font: 10px sans-serif;&#13;
&#13;
  text-anchor: end;&#13;
&#13;
}&#13;
&#13;
.centered-chart {&#13;
&#13;
  text-align: center;&#13;
&#13;
}</css>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>true</has_preview>
        <id>bar_graph_widget</id>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {  }]]></link>
        <name>Bar Graph Widget</name>
        <option_schema/>
        <public>false</public>
        <roles/>
        <script><![CDATA[(function() {
  /* populate the 'data' object */
  /* e.g., data.table = $sp.getValue('table'); */
 data.categories = [{"category": "Critical","value": 0}, {"category": "High","value": 0}, {"category": "Moderate","value": 0}, {"category": "Low","value": 0}];



var gr;

for (var i = 0; i < data.categories.length; i++){
	
	gr = new GlideRecord('incident');
	if(data.categories[i]['category']== 'Critical'){
		gr.addEncodedQuery('priority=1');
	}else if(data.categories[i]['category']== 'High'){
		gr.addEncodedQuery('priority=2');
	}else if(data.categories[i]['category']== 'Moderate'){
		gr.addEncodedQuery('priority=3');
	}else if(data.categories[i]['category']== 'Low'){
		gr.addEncodedQuery('priority=4');
	}

	gr.query();

	while(gr.next()){ data.categories[i]['value']= data.categories[i]['value']+1;}

}
	
})();]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2022-03-19 01:47:26</sys_created_on>
        <sys_id>080ff0422f52011014b2ffecf699b63b</sys_id>
        <sys_mod_count>21</sys_mod_count>
        <sys_name>Bar Graph Widget</sys_name>
        <sys_package display_value="NeedIt" source="x_58872_needit">6ead8e780f603200cd674f8ce1050ed1</sys_package>
        <sys_policy/>
        <sys_scope display_value="NeedIt">6ead8e780f603200cd674f8ce1050ed1</sys_scope>
        <sys_update_name>sp_widget_080ff0422f52011014b2ffecf699b63b</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2022-03-19 22:49:43</sys_updated_on>
        <template><![CDATA[<div class="centered-chart">

	<h1>D3 Bar Chart</h1>

	<svg class="chart"></svg>

</div>]]></template>
    </sp_widget>
</record_update>
